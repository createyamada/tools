import java.sql.*;

public class OracleQueryExample {

    // PDBのJDBC URL
    private static final String URL = "jdbc:oracle:thin:@//localhost:1521/ORCLPDB1";

    // スキーマのユーザー名 & パスワード
    private static final String USER = "TARGET_SCHEMA";  // ←特定スキーマのユーザー名
    private static final String PASSWORD = "password";

    public static void main(String[] args) {
        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;

        try {
            // 1. JDBCドライバ読み込み（最近は不要なことも多い）
            Class.forName("oracle.jdbc.driver.OracleDriver");

            // 2. 接続
            conn = DriverManager.getConnection(URL, USER, PASSWORD);
            System.out.println("Connected to Oracle PDB!");

            // 3. SQLクエリ（特定テーブル）
            String sql = "SELECT * FROM TARGET_SCHEMA.MY_TABLE WHERE ROWNUM <= 10";
            pstmt = conn.prepareStatement(sql);

            // 4. 実行
            rs = pstmt.executeQuery();

            // 5. 結果表示
            while (rs.next()) {
                // カラム名を指定する
                System.out.println("ID: " + rs.getInt("ID"));
                System.out.println("NAME: " + rs.getString("NAME"));
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // 6. 終了処理
            try { if (rs != null) rs.close(); } catch (Exception e) {}
            try { if (pstmt != null) pstmt.close(); } catch (Exception e) {}
            try { if (conn != null) conn.close(); } catch (Exception e) {}
        }
    }
}
